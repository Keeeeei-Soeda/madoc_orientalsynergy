# ç¤¾å“¡å…±é€šã‚¢ã‚«ã‚¦ãƒ³ãƒˆæ©Ÿèƒ½ è¨­è¨ˆæ›¸

## ğŸ“‹ æ¦‚è¦

ä¼æ¥­ã”ã¨ã«ç¤¾å“¡å…±é€šã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ç™ºè¡Œã—ã€ç¤¾å“¡ãŒäºˆç´„ç™»éŒ²ã®ã¿ã‚’è¡Œãˆã‚‹ã‚ˆã†ã«ã™ã‚‹æ©Ÿèƒ½ã®è¨­è¨ˆæ›¸ã§ã™ã€‚

## ğŸ¯ è¦ä»¶

1. **ä¼æ¥­ã”ã¨ã«ç¤¾å“¡å…±é€šã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ç™ºè¡Œ**
   - 1ã¤ã®ä¼æ¥­ã«ã¤ã1ã¤ã®ç¤¾å“¡ç”¨å…±é€šã‚¢ã‚«ã‚¦ãƒ³ãƒˆ
   - ä¼æ¥­å + "ï¼ˆç¤¾å“¡ç”¨ï¼‰" ã®ã‚ˆã†ãªå‘½åè¦å‰‡

2. **ç¤¾å“¡ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³ãƒ»äºˆç´„ç™»éŒ²ãŒå¯èƒ½**
   - `/company/employee-bookings` ãƒšãƒ¼ã‚¸ã«ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
   - å‹Ÿé›†ä¸­ã®äºˆç´„ä¸€è¦§ã‚’è¡¨ç¤º
   - ç¤¾å“¡æƒ…å ±ã‚’å…¥åŠ›ã—ã¦å‚åŠ ç™»éŒ²

3. **ã‚¢ã‚¯ã‚»ã‚¹åˆ¶é™**
   - äºˆç´„ç™»éŒ²ãƒšãƒ¼ã‚¸ä»¥å¤–ã¯é–²è¦§ä¸å¯
   - ã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚„ãƒ˜ãƒƒãƒ€ãƒ¼ã®ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã¯éè¡¨ç¤º

---

## ğŸ—ï¸ å®Ÿè£…ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ

### æ–¹æ³•1: æ–°ã—ã„ãƒ­ãƒ¼ãƒ«ã€ŒEMPLOYEEã€ã‚’è¿½åŠ ï¼ˆæ¨å¥¨ï¼‰

#### ãƒ¡ãƒªãƒƒãƒˆ
- æ¨©é™ã‚’æ˜ç¢ºã«åˆ†é›¢ã§ãã‚‹
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãŒé«˜ã„
- å°†æ¥çš„ãªæ‹¡å¼µãŒå®¹æ˜“

#### ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒã®å¤‰æ›´ãŒå¿…è¦
- æ—¢å­˜ã®ãƒ­ãƒ¼ãƒ«ç®¡ç†ã‚³ãƒ¼ãƒ‰ã®ä¿®æ­£ãŒå¿…è¦

### æ–¹æ³•2: æ—¢å­˜ã®ã€ŒCOMPANYã€ãƒ­ãƒ¼ãƒ«ã‚’ä½¿ç”¨ï¼ˆç°¡æ˜“ç‰ˆï¼‰

#### ãƒ¡ãƒªãƒƒãƒˆ
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å¤‰æ›´ä¸è¦
- å®Ÿè£…ãŒæ—©ã„

#### ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ
- æ¨©é™ã®åˆ†é›¢ãŒä¸ååˆ†
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒªã‚¹ã‚¯ãŒã‚ã‚‹
- å°†æ¥çš„ãªä¿å®ˆæ€§ãŒä½ã„

**â†’ æ–¹æ³•1ï¼ˆEMPLOYEEãƒ­ãƒ¼ãƒ«è¿½åŠ ï¼‰ã‚’æ¨å¥¨ã—ã¾ã™**

---

## ğŸ“Š ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ

### Userãƒ†ãƒ¼ãƒ–ãƒ«ã®ä¿®æ­£

**ç¾çŠ¶ã®UserRole enum:**
```python
class UserRole(str, enum.Enum):
    ADMIN = "admin"
    COMPANY = "company"
    STAFF = "staff"
```

**ä¿®æ­£å¾Œ:**
```python
class UserRole(str, enum.Enum):
    ADMIN = "admin"
    COMPANY = "company"
    STAFF = "staff"
    EMPLOYEE = "employee"  # æ–°è¦è¿½åŠ 
```

### ç¤¾å“¡ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | å‹ | èª¬æ˜ |
|-----------|---|------|
| id | Integer | ãƒ¦ãƒ¼ã‚¶ãƒ¼ID |
| email | String | ãƒ­ã‚°ã‚¤ãƒ³ç”¨ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆä¾‹: company1-employees@example.comï¼‰ |
| password_hash | String | ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ¥ |
| name | String | ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåï¼ˆä¾‹: æ ªå¼ä¼šç¤¾Aï¼ˆç¤¾å“¡ç”¨ï¼‰ï¼‰ |
| role | Enum | "employee" å›ºå®š |
| is_active | Boolean | ã‚¢ã‚¯ãƒ†ã‚£ãƒ–çŠ¶æ…‹ |
| company_id | Integer | æ‰€å±ä¼æ¥­IDï¼ˆæ—¢å­˜ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¾ãŸã¯æ–°è¦è¿½åŠ ï¼‰ |

---

## ğŸ” æ¨©é™è¨­è¨ˆ

### EMPLOYEEãƒ­ãƒ¼ãƒ«ã®æ¨©é™

| æ©Ÿèƒ½ | æ¨©é™ | å‚™è€ƒ |
|-----|------|------|
| `/company/employee-bookings` | âœ… è¨±å¯ | äºˆç´„ç™»éŒ²ãƒšãƒ¼ã‚¸ã®ã¿ |
| ãã®ä»–ã®ä¼æ¥­å´ãƒšãƒ¼ã‚¸ | âŒ æ‹’å¦ | ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã€äºˆç´„ç®¡ç†ãªã© |
| ç®¡ç†è€…å´ãƒšãƒ¼ã‚¸ | âŒ æ‹’å¦ | - |
| ã‚¹ã‚¿ãƒƒãƒ•å´ãƒšãƒ¼ã‚¸ | âŒ æ‹’å¦ | - |

### APIæ¨©é™

| ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | æ¨©é™ | èª¬æ˜ |
|--------------|------|------|
| `GET /api/v1/reservations?status=recruiting` | âœ… è¨±å¯ | å‹Ÿé›†ä¸­ã®äºˆç´„ä¸€è¦§ï¼ˆè‡ªç¤¾ã®ã¿ï¼‰ |
| `POST /api/v1/reservations/{id}/employees` | âœ… è¨±å¯ | ç¤¾å“¡å‚åŠ ç™»éŒ² |
| ãã®ä»–ã®äºˆç´„API | âŒ æ‹’å¦ | ä½œæˆãƒ»æ›´æ–°ãƒ»å‰Šé™¤ã¯ä¸å¯ |
| ä¼æ¥­æƒ…å ±API | âŒ æ‹’å¦ | - |
| ç¤¾å“¡ç®¡ç†API | âŒ æ‹’å¦ | - |

---

## ğŸ’» å®Ÿè£…å†…å®¹

### 1. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ä¿®æ­£

#### 1-1. UserRoleã®æ›´æ–°

**ãƒ•ã‚¡ã‚¤ãƒ«:** `backend/app/models/user.py`

```python
class UserRole(str, enum.Enum):
    ADMIN = "admin"
    COMPANY = "company"
    STAFF = "staff"
    EMPLOYEE = "employee"  # è¿½åŠ 
```

#### 1-2. Userãƒ¢ãƒ‡ãƒ«ã«company_idã‚’è¿½åŠ ï¼ˆå¿…è¦ãªå ´åˆï¼‰

**ãƒ•ã‚¡ã‚¤ãƒ«:** `backend/app/models/user.py`

```python
class User(Base):
    __tablename__ = "users"
    
    id = Column(Integer, primary_key=True, index=True)
    email = Column(String(255), unique=True, index=True, nullable=False)
    password_hash = Column(String(255), nullable=False)
    name = Column(String(100), nullable=False)
    role = Column(SQLEnum(UserRole), nullable=False)
    is_active = Column(Boolean, default=True, nullable=False)
    company_id = Column(Integer, ForeignKey("companies.id"), nullable=True)  # è¿½åŠ 
    created_at = Column(DateTime(timezone=True), server_default=func.now())
    updated_at = Column(DateTime(timezone=True), server_default=func.now(), onupdate=func.now())
```

#### 1-3. ç¤¾å“¡å‚åŠ ç™»éŒ²APIã®å®Ÿè£…

**ãƒ•ã‚¡ã‚¤ãƒ«:** `backend/app/api/v1/reservations.py`

```python
from fastapi import APIRouter, Depends, HTTPException, status
from sqlalchemy.orm import Session
from typing import Optional

# æ–°ã—ã„ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
@router.post("/reservations/{reservation_id}/employees")
def add_employee_to_reservation(
    reservation_id: int,
    employee_data: EmployeeRegistration,
    db: Session = Depends(get_db),
    current_user: User = Depends(get_current_user)
):
    """
    äºˆç´„ã«ç¤¾å“¡ã‚’å‚åŠ ç™»éŒ²
    
    æ¨©é™: EMPLOYEEã¾ãŸã¯COMPANYãƒ­ãƒ¼ãƒ«
    """
    # EMPLOYEEã¾ãŸã¯COMPANYãƒ­ãƒ¼ãƒ«ã®ã¿è¨±å¯
    if current_user.role not in [UserRole.EMPLOYEE, UserRole.COMPANY]:
        raise HTTPException(
            status_code=status.HTTP_403_FORBIDDEN,
            detail="ã“ã®æ©Ÿèƒ½ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“"
        )
    
    # äºˆç´„ã‚’å–å¾—
    reservation = db.query(Reservation).filter(
        Reservation.id == reservation_id
    ).first()
    
    if not reservation:
        raise HTTPException(
            status_code=status.HTTP_404_NOT_FOUND,
            detail="äºˆç´„ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"
        )
    
    # è‡ªç¤¾ã®äºˆç´„ã‹ãƒã‚§ãƒƒã‚¯
    if current_user.company_id != reservation.company_id:
        raise HTTPException(
            status_code=status.HTTP_403_FORBIDDEN,
            detail="ä»–ç¤¾ã®äºˆç´„ã«ã¯ç™»éŒ²ã§ãã¾ã›ã‚“"
        )
    
    # ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒã‚§ãƒƒã‚¯
    if reservation.status != ReservationStatus.RECRUITING:
        raise HTTPException(
            status_code=status.HTTP_400_BAD_REQUEST,
            detail="ã“ã®äºˆç´„ã¯å‹Ÿé›†ä¸­ã§ã¯ã‚ã‚Šã¾ã›ã‚“"
        )
    
    # å‹Ÿé›†äººæ•°ãƒã‚§ãƒƒã‚¯
    current_employees = reservation.employee_names.split(',') if reservation.employee_names else []
    current_employees = [e.strip() for e in current_employees if e.strip()]
    
    if len(current_employees) >= reservation.max_participants:
        raise HTTPException(
            status_code=status.HTTP_400_BAD_REQUEST,
            detail="å‹Ÿé›†äººæ•°ã«é”ã—ã¦ã„ã¾ã™"
        )
    
    # ç¤¾å“¡ã‚’è¿½åŠ 
    new_employee_name = employee_data.employee_name
    current_employees.append(new_employee_name)
    reservation.employee_names = ', '.join(current_employees)
    
    db.commit()
    db.refresh(reservation)
    
    return {
        "message": "ç¤¾å“¡ã®å‚åŠ ç™»éŒ²ãŒå®Œäº†ã—ã¾ã—ãŸ",
        "reservation": reservation
    }


# å‹Ÿé›†ä¸­ã®äºˆç´„ä¸€è¦§å–å¾—ï¼ˆEMPLOYEEãƒ­ãƒ¼ãƒ«ç”¨ï¼‰
@router.get("/reservations/recruiting")
def get_recruiting_reservations(
    db: Session = Depends(get_db),
    current_user: User = Depends(get_current_user)
):
    """
    å‹Ÿé›†ä¸­ã®äºˆç´„ä¸€è¦§ã‚’å–å¾—ï¼ˆè‡ªç¤¾ã®ã¿ï¼‰
    
    æ¨©é™: EMPLOYEE, COMPANY, ADMIN
    """
    query = db.query(Reservation).filter(
        Reservation.status == ReservationStatus.RECRUITING
    )
    
    # EMPLOYEEã¾ãŸã¯COMPANYãƒ­ãƒ¼ãƒ«ã®å ´åˆã¯è‡ªç¤¾ã®ã¿
    if current_user.role in [UserRole.EMPLOYEE, UserRole.COMPANY]:
        if not current_user.company_id:
            raise HTTPException(
                status_code=status.HTTP_400_BAD_REQUEST,
                detail="ä¼æ¥­æƒ…å ±ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“"
            )
        query = query.filter(Reservation.company_id == current_user.company_id)
    
    reservations = query.order_by(Reservation.reservation_date.asc()).all()
    return reservations
```

#### 1-4. EmployeeRegistrationã‚¹ã‚­ãƒ¼ãƒã®è¿½åŠ 

**ãƒ•ã‚¡ã‚¤ãƒ«:** `backend/app/schemas/reservation.py`

```python
class EmployeeRegistration(BaseModel):
    """ç¤¾å“¡å‚åŠ ç™»éŒ²ã‚¹ã‚­ãƒ¼ãƒ"""
    employee_name: str = Field(..., description="ç¤¾å“¡å")
    department: str = Field(..., description="éƒ¨ç½²")
    position: Optional[str] = Field(None, description="å½¹è·")
    phone: Optional[str] = Field(None, description="é›»è©±ç•ªå·")
    email: Optional[str] = Field(None, description="ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹")
    notes: Optional[str] = Field(None, description="å‚™è€ƒãƒ»è¦æœ›")
```

#### 1-5. æ¨©é™ãƒã‚§ãƒƒã‚¯é–¢æ•°ã®è¿½åŠ 

**ãƒ•ã‚¡ã‚¤ãƒ«:** `backend/app/api/dependencies.py`

```python
def get_employee_user(current_user: User = Depends(get_current_active_user)) -> User:
    """EMPLOYEEãƒ­ãƒ¼ãƒ«ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿è¨±å¯"""
    if current_user.role != UserRole.EMPLOYEE:
        raise HTTPException(
            status_code=status.HTTP_403_FORBIDDEN,
            detail="ç¤¾å“¡ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã§ã™"
        )
    return current_user

def get_employee_or_company_user(current_user: User = Depends(get_current_active_user)) -> User:
    """EMPLOYEEã¾ãŸã¯COMPANYãƒ­ãƒ¼ãƒ«ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿è¨±å¯"""
    if current_user.role not in [UserRole.EMPLOYEE, UserRole.COMPANY]:
        raise HTTPException(
            status_code=status.HTTP_403_FORBIDDEN,
            detail="ã“ã®æ©Ÿèƒ½ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“"
        )
    return current_user
```

---

### 2. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ä¿®æ­£

#### 2-1. Userã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®æ›´æ–°

**ãƒ•ã‚¡ã‚¤ãƒ«:** `frontend/src/lib/auth/AuthContext.tsx`

```typescript
export interface User {
  id: number
  email: string
  name: string
  role: 'ADMIN' | 'COMPANY' | 'STAFF' | 'EMPLOYEE'  // EMPLOYEEã‚’è¿½åŠ 
  is_active: boolean
  company_id?: number
}
```

#### 2-2. ç¤¾å“¡ç”¨ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã®ä½œæˆ

**ãƒ•ã‚¡ã‚¤ãƒ«:** `frontend/src/app/employee/layout.tsx`

```tsx
'use client'

import React from 'react'
import { AuthGuard } from '@/lib/auth/AuthGuard'
import { useRouter } from 'next/navigation'
import { useAuth } from '@/lib/auth/AuthContext'

export default function EmployeeLayout({
  children,
}: {
  children: React.ReactNode
}) {
  const router = useRouter()
  const { logout } = useAuth()
  
  const handleLogout = () => {
    logout()
    router.push('/login')
  }
  
  return (
    <AuthGuard allowedRoles={['EMPLOYEE']}>
      <div className="employee-layout">
        {/* ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ˜ãƒƒãƒ€ãƒ¼ã®ã¿ */}
        <header className="employee-header">
          <div className="container">
            <div className="d-flex justify-content-between align-items-center py-3">
              <h4 className="mb-0">äºˆç´„ç™»éŒ²ï¼ˆç¤¾å“¡ç”¨ï¼‰</h4>
              <button 
                className="btn btn-outline-secondary btn-sm"
                onClick={handleLogout}
              >
                <i className="bi bi-box-arrow-right me-2"></i>
                ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
              </button>
            </div>
          </div>
        </header>
        
        {/* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */}
        <main className="employee-content">
          <div className="container py-4">
            {children}
          </div>
        </main>
        
        {/* ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ•ãƒƒã‚¿ãƒ¼ */}
        <footer className="employee-footer text-center py-3 mt-auto">
          <p className="text-muted small mb-0">
            Â© 2026 Oriental Synergy
          </p>
        </footer>
      </div>
      
      <style jsx global>{`
        .employee-layout {
          min-height: 100vh;
          display: flex;
          flex-direction: column;
          background-color: #f8f9fa;
        }
        
        .employee-header {
          background-color: #fff;
          border-bottom: 1px solid #dee2e6;
          box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .employee-content {
          flex: 1;
        }
        
        .employee-footer {
          background-color: #fff;
          border-top: 1px solid #dee2e6;
        }
      `}</style>
    </AuthGuard>
  )
}
```

#### 2-3. employee-bookingsãƒšãƒ¼ã‚¸ã‚’ç§»å‹•

**ç§»å‹•å…ƒ:** `frontend/src/app/company/employee-bookings/page.tsx`  
**ç§»å‹•å…ˆ:** `frontend/src/app/employee/bookings/page.tsx`

```tsx
// ãƒšãƒ¼ã‚¸å†…å®¹ã¯åŒã˜ã§ã™ãŒã€APIã‚’å®Ÿéš›ã«å‘¼ã³å‡ºã™ã‚ˆã†ã«ä¿®æ­£
'use client'

import React, { useState, useEffect } from 'react'
import { reservationsApi, employeeBookingsApi } from '@/lib/api'
import { useAuth } from '@/lib/auth/AuthContext'
// ... (ä»¥ä¸‹ã€æ—¢å­˜ã®ã‚³ãƒ¼ãƒ‰ã‚’å®ŸAPIã«æ¥ç¶š)
```

#### 2-4. APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®è¿½åŠ 

**ãƒ•ã‚¡ã‚¤ãƒ«:** `frontend/src/lib/api.ts`

```typescript
// ç¤¾å“¡äºˆç´„ç™»éŒ²API
export const employeeBookingsApi = {
  // å‹Ÿé›†ä¸­ã®äºˆç´„ä¸€è¦§å–å¾—
  getRecruitingReservations: async (): Promise<Reservation[]> => {
    const response = await apiClient.get('/reservations/recruiting')
    return response.data
  },
  
  // ç¤¾å“¡å‚åŠ ç™»éŒ²
  registerEmployee: async (
    reservationId: number, 
    data: EmployeeRegistration
  ): Promise<Reservation> => {
    const response = await apiClient.post(
      `/reservations/${reservationId}/employees`,
      data
    )
    return response.data
  },
}

export interface EmployeeRegistration {
  employee_name: string
  department: string
  position?: string
  phone?: string
  email?: string
  notes?: string
}
```

#### 2-5. ãƒ­ã‚°ã‚¤ãƒ³å¾Œã®ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå‡¦ç†ã®æ›´æ–°

**ãƒ•ã‚¡ã‚¤ãƒ«:** `frontend/src/app/login/page.tsx`

```typescript
// ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸå¾Œã®ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
const handleLogin = async (e: React.FormEvent) => {
  e.preventDefault()
  
  try {
    const userData = await login(email, password)
    
    // ãƒ­ãƒ¼ãƒ«ã«å¿œã˜ã¦ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
    switch (userData.role) {
      case 'ADMIN':
        router.push('/admin/dashboard')
        break
      case 'COMPANY':
        router.push('/company/dashboard')
        break
      case 'STAFF':
        router.push('/staff/dashboard')
        break
      case 'EMPLOYEE':
        router.push('/employee/bookings')  // ç¤¾å“¡ç”¨ãƒšãƒ¼ã‚¸ã¸
        break
      default:
        router.push('/')
    }
  } catch (error) {
    setError('ãƒ­ã‚°ã‚¤ãƒ³ã«å¤±æ•—ã—ã¾ã—ãŸ')
  }
}
```

---

### 3. ç¤¾å“¡ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆæ©Ÿèƒ½

#### 3-1. ç®¡ç†è€…ç”»é¢ã«ç¤¾å“¡ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆæ©Ÿèƒ½ã‚’è¿½åŠ 

**ãƒ•ã‚¡ã‚¤ãƒ«:** `frontend/src/app/admin/companies/[id]/page.tsx`

ä¼æ¥­è©³ç´°ãƒšãƒ¼ã‚¸ã«ã€Œç¤¾å“¡ç”¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆã€ãƒœã‚¿ãƒ³ã‚’è¿½åŠ 

```tsx
<button
  className="btn btn-success"
  onClick={handleCreateEmployeeAccount}
>
  <i className="bi bi-people me-2"></i>
  ç¤¾å“¡ç”¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆ
</button>
```

#### 3-2. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIã®è¿½åŠ 

**ãƒ•ã‚¡ã‚¤ãƒ«:** `backend/app/api/v1/companies.py`

```python
@router.post("/companies/{company_id}/employee-account")
def create_employee_account(
    company_id: int,
    password: str = Body(..., embed=True),
    db: Session = Depends(get_db),
    current_user: User = Depends(get_admin_user)
):
    """
    ä¼æ¥­ã®ç¤¾å“¡ç”¨å…±é€šã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆ
    
    æ¨©é™: ç®¡ç†è€…ã®ã¿
    """
    # ä¼æ¥­ã‚’å–å¾—
    company = db.query(Company).filter(Company.id == company_id).first()
    if not company:
        raise HTTPException(
            status_code=status.HTTP_404_NOT_FOUND,
            detail="ä¼æ¥­ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"
        )
    
    # æ—¢ã«ç¤¾å“¡ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒå­˜åœ¨ã™ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
    existing_account = db.query(User).filter(
        User.company_id == company_id,
        User.role == UserRole.EMPLOYEE
    ).first()
    
    if existing_account:
        raise HTTPException(
            status_code=status.HTTP_400_BAD_REQUEST,
            detail="æ—¢ã«ç¤¾å“¡ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒå­˜åœ¨ã—ã¾ã™"
        )
    
    # ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ç”Ÿæˆï¼ˆä¾‹: company_1_employees@example.comï¼‰
    email = f"company_{company_id}_employees@example.com"
    
    # ç¤¾å“¡ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆ
    employee_account = User(
        email=email,
        password_hash=get_password_hash(password),
        name=f"{company.name}ï¼ˆç¤¾å“¡ç”¨ï¼‰",
        role=UserRole.EMPLOYEE,
        is_active=True,
        company_id=company_id
    )
    
    db.add(employee_account)
    db.commit()
    db.refresh(employee_account)
    
    return {
        "message": "ç¤¾å“¡ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸ",
        "account": {
            "id": employee_account.id,
            "email": employee_account.email,
            "name": employee_account.name,
            "company_id": employee_account.company_id
        }
    }
```

---

## ğŸš€ å®Ÿè£…æ‰‹é †

### ã‚¹ãƒ†ãƒƒãƒ—1: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æº–å‚™

1. UserRoleã«EMPLOYEEã‚’è¿½åŠ 
2. ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œ
3. æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã¸ã®å½±éŸ¿ç¢ºèª

```bash
# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ä½œæˆ
alembic revision --autogenerate -m "Add EMPLOYEE role to UserRole enum"

# ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
alembic upgrade head
```

### ã‚¹ãƒ†ãƒƒãƒ—2: ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å®Ÿè£…

1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¢ãƒ‡ãƒ«ã®æ›´æ–°
2. ç¤¾å“¡å‚åŠ ç™»éŒ²APIã®å®Ÿè£…
3. æ¨©é™ãƒã‚§ãƒƒã‚¯é–¢æ•°ã®è¿½åŠ 
4. ç¤¾å“¡ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆAPIã®å®Ÿè£…

### ã‚¹ãƒ†ãƒƒãƒ—3: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å®Ÿè£…

1. AuthContextã®æ›´æ–°ï¼ˆEMPLOYEEãƒ­ãƒ¼ãƒ«è¿½åŠ ï¼‰
2. ç¤¾å“¡ç”¨ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã®ä½œæˆ
3. employee-bookingsãƒšãƒ¼ã‚¸ã®ç§»å‹•ã¨ä¿®æ­£
4. APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®è¿½åŠ 
5. ãƒ­ã‚°ã‚¤ãƒ³å¾Œã®ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå‡¦ç†æ›´æ–°

### ã‚¹ãƒ†ãƒƒãƒ—4: ç®¡ç†è€…ç”»é¢ã®æ›´æ–°

1. ä¼æ¥­è©³ç´°ãƒšãƒ¼ã‚¸ã«ç¤¾å“¡ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆãƒœã‚¿ãƒ³è¿½åŠ 
2. ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆãƒ¢ãƒ¼ãƒ€ãƒ«ã®å®Ÿè£…
3. ä½œæˆå¾Œã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±è¡¨ç¤º

### ã‚¹ãƒ†ãƒƒãƒ—5: ãƒ†ã‚¹ãƒˆ

1. ç¤¾å“¡ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ä½œæˆ
2. ç¤¾å“¡ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ã®ãƒ­ã‚°ã‚¤ãƒ³
3. äºˆç´„ä¸€è¦§ã®è¡¨ç¤º
4. ç¤¾å“¡å‚åŠ ç™»éŒ²
5. ã‚¢ã‚¯ã‚»ã‚¹åˆ¶é™ã®ç¢ºèª

---

## ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®äº‹é …

1. **ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç®¡ç†**
   - ç¤¾å“¡ç”¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯ä¼æ¥­æ‹…å½“è€…ã«é€šçŸ¥
   - å®šæœŸçš„ãªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´ã‚’æ¨å¥¨

2. **ã‚¢ã‚¯ã‚»ã‚¹åˆ¶é™**
   - AuthGuardã§ç¢ºå®Ÿã«ãƒ­ãƒ¼ãƒ«ãƒã‚§ãƒƒã‚¯
   - ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§ã‚‚äºŒé‡ãƒã‚§ãƒƒã‚¯

3. **ãƒ‡ãƒ¼ã‚¿åˆ†é›¢**
   - ç¤¾å“¡ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¯è‡ªç¤¾ã®äºˆç´„ã®ã¿é–²è¦§å¯èƒ½
   - company_idã§å³æ ¼ã«ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°

4. **ãƒ­ã‚°è¨˜éŒ²**
   - ç¤¾å“¡ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ä½œæˆå±¥æ­´
   - äºˆç´„ç™»éŒ²ã®å±¥æ­´

---

## ğŸ“ é‹ç”¨ãƒ•ãƒ­ãƒ¼

### 1. ç¤¾å“¡ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ

```
1. ç®¡ç†è€…ãŒä¼æ¥­è©³ç´°ãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹
   â†“
2. ã€Œç¤¾å“¡ç”¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
   â†“
3. ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’è¨­å®š
   â†“
4. ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±ï¼ˆãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼‰ã‚’ä¼æ¥­æ‹…å½“è€…ã«é€šçŸ¥
```

### 2. ç¤¾å“¡ã«ã‚ˆã‚‹äºˆç´„ç™»éŒ²

```
1. ç¤¾å“¡ãŒå…±é€šã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³
   â†“
2. /employee/bookings ã«è‡ªå‹•çš„ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
   â†“
3. å‹Ÿé›†ä¸­ã®äºˆç´„ä¸€è¦§ã‚’è¡¨ç¤º
   â†“
4. äºˆç´„ã‚’é¸æŠã—ã¦è©³ç´°ã‚’ç¢ºèª
   â†“
5. ç¤¾å“¡æƒ…å ±ã‚’å…¥åŠ›ã—ã¦ç™»éŒ²
   â†“
6. ç™»éŒ²å®Œäº†
```

---

## âš ï¸ æ³¨æ„äº‹é …

1. **å…±é€šã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒªã‚¹ã‚¯**
   - è¤‡æ•°ã®ç¤¾å“¡ãŒåŒã˜ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½¿ç”¨
   - èª°ãŒç™»éŒ²ã—ãŸã‹è¿½è·¡ã§ããªã„
   - å°†æ¥çš„ã«ã¯å€‹åˆ¥ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¸ã®ç§»è¡Œã‚’æ¨å¥¨

2. **å°†æ¥ã®æ‹¡å¼µæ€§**
   - å€‹åˆ¥ã®ç¤¾å“¡ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæ©Ÿèƒ½
   - LINEãƒ­ã‚°ã‚¤ãƒ³é€£æº
   - ã‚·ãƒ³ã‚°ãƒ«ã‚µã‚¤ãƒ³ã‚ªãƒ³ (SSO)

---

## ğŸ“ˆ å®Ÿè£…å·¥æ•°è¦‹ç©ã‚‚ã‚Š

| ã‚¿ã‚¹ã‚¯ | å·¥æ•° |
|-------|------|
| ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆãƒ»ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ | 2æ™‚é–“ |
| ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIå®Ÿè£… | 4æ™‚é–“ |
| ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å®Ÿè£… | 6æ™‚é–“ |
| ç®¡ç†è€…ç”»é¢ã®æ›´æ–° | 3æ™‚é–“ |
| ãƒ†ã‚¹ãƒˆãƒ»ãƒ‡ãƒãƒƒã‚° | 4æ™‚é–“ |
| ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆ | 1æ™‚é–“ |
| **åˆè¨ˆ** | **ç´„20æ™‚é–“ï¼ˆ2.5æ—¥ï¼‰** |

---

## âœ… ã¾ã¨ã‚

ã”è¦æœ›ã®æ©Ÿèƒ½ã¯ **å®Ÿç¾å¯èƒ½** ã§ã™ã€‚

### æ¨å¥¨å®Ÿè£…æ–¹æ³•
- æ–°ã—ã„ãƒ­ãƒ¼ãƒ«ã€ŒEMPLOYEEã€ã‚’è¿½åŠ 
- ä¼æ¥­ã”ã¨ã«ç¤¾å“¡ç”¨å…±é€šã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ç™ºè¡Œ
- å°‚ç”¨ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã§äºˆç´„ç™»éŒ²ãƒšãƒ¼ã‚¸ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½

### ä¸»ãªé–‹ç™ºå†…å®¹
1. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰: UserRoleã®è¿½åŠ ã€APIå®Ÿè£…
2. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰: ç¤¾å“¡ç”¨ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã€APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
3. ç®¡ç†è€…ç”»é¢: ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆæ©Ÿèƒ½

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
- ãƒ­ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã®ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
- company_idã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿åˆ†é›¢
- AuthGuardã¨ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®äºŒé‡ãƒã‚§ãƒƒã‚¯

å®Ÿè£…ã‚’é€²ã‚ã¦ã‚ˆã‚ã—ã„ã§ã—ã‚‡ã†ã‹ï¼Ÿ

---

æœ€çµ‚æ›´æ–°æ—¥: 2026å¹´1æœˆ23æ—¥


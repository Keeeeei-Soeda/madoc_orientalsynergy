# Phase 2A: ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIå®Œæˆ - å®Œäº†å ±å‘Š

## ğŸ“… å®Ÿè£…æ—¥æ™‚
2026å¹´1æœˆ8æ—¥

## âœ… å®Œäº†ã—ãŸé …ç›®

### 1. JWTèªè¨¼ã‚·ã‚¹ãƒ†ãƒ å®Ÿè£…
- âœ… ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ¥åŒ–ï¼ˆbcryptï¼‰
- âœ… JWTãƒˆãƒ¼ã‚¯ãƒ³ç”Ÿæˆãƒ»æ¤œè¨¼
- âœ… ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ï¼ˆ30åˆ†æœ‰åŠ¹æœŸé™ï¼‰
- âœ… ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ï¼ˆ7æ—¥é–“æœ‰åŠ¹æœŸé™ï¼‰
- âœ… ãƒ­ã‚°ã‚¤ãƒ³/ãƒ­ã‚°ã‚¢ã‚¦ãƒˆAPI
- âœ… ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—API

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«:**
- `backend/app/core/security.py` - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£é–¢æ•°
- `backend/app/api/v1/auth.py` - èªè¨¼API
- `backend/app/schemas/token.py` - ãƒˆãƒ¼ã‚¯ãƒ³ã‚¹ã‚­ãƒ¼ãƒ

### 2. èªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã¨æ¨©é™ç®¡ç†
- âœ… HTTPãƒ™ã‚¢ãƒ©ãƒ¼èªè¨¼
- âœ… ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼å–å¾—ï¼ˆä¾å­˜æ€§æ³¨å…¥ï¼‰
- âœ… ãƒ­ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ï¼ˆRBACï¼‰
  - ç®¡ç†è€…ã®ã¿ï¼ˆ`get_admin_user`ï¼‰
  - ä¼æ¥­ã¾ãŸã¯ç®¡ç†è€…ï¼ˆ`get_company_user`ï¼‰
  - ã‚¹ã‚¿ãƒƒãƒ•ã¾ãŸã¯ç®¡ç†è€…ï¼ˆ`get_staff_user`ï¼‰

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«:**
- `backend/app/api/deps.py` - ä¾å­˜æ€§æ³¨å…¥

### 3. ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†APIï¼ˆå®Œå…¨å®Ÿè£…ï¼‰
- âœ… GET `/api/v1/users` - ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ï¼ˆç®¡ç†è€…ã®ã¿ï¼‰
- âœ… GET `/api/v1/users/{id}` - ãƒ¦ãƒ¼ã‚¶ãƒ¼è©³ç´°ï¼ˆç®¡ç†è€…ã®ã¿ï¼‰
- âœ… POST `/api/v1/users` - ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆï¼ˆç®¡ç†è€…ã®ã¿ï¼‰
- âœ… PUT `/api/v1/users/{id}` - ãƒ¦ãƒ¼ã‚¶ãƒ¼æ›´æ–°ï¼ˆç®¡ç†è€…ã®ã¿ï¼‰
- âœ… DELETE `/api/v1/users/{id}` - ãƒ¦ãƒ¼ã‚¶ãƒ¼å‰Šé™¤ï¼ˆç®¡ç†è€…ã®ã¿ï¼‰

### 4. ä¼æ¥­ç®¡ç†APIï¼ˆå®Œå…¨å®Ÿè£…ï¼‰
- âœ… GET `/api/v1/companies` - ä¼æ¥­ä¸€è¦§ï¼ˆæ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ä»˜ãï¼‰
- âœ… GET `/api/v1/companies/{id}` - ä¼æ¥­è©³ç´°
- âœ… POST `/api/v1/companies` - ä¼æ¥­ä½œæˆï¼ˆç®¡ç†è€…ã®ã¿ï¼‰
- âœ… PUT `/api/v1/companies/{id}` - ä¼æ¥­æ›´æ–°ï¼ˆç®¡ç†è€…ã®ã¿ï¼‰
- âœ… DELETE `/api/v1/companies/{id}` - ä¼æ¥­å‰Šé™¤ï¼ˆç®¡ç†è€…ã®ã¿ï¼‰

### 5. ã‚¹ã‚¿ãƒƒãƒ•ç®¡ç†APIï¼ˆå®Œå…¨å®Ÿè£…ï¼‰
- âœ… GET `/api/v1/staff` - ã‚¹ã‚¿ãƒƒãƒ•ä¸€è¦§ï¼ˆæ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ä»˜ãï¼‰
- âœ… GET `/api/v1/staff/{id}` - ã‚¹ã‚¿ãƒƒãƒ•è©³ç´°
- âœ… POST `/api/v1/staff` - ã‚¹ã‚¿ãƒƒãƒ•ä½œæˆï¼ˆç®¡ç†è€…ã®ã¿ï¼‰
- âœ… PUT `/api/v1/staff/{id}` - ã‚¹ã‚¿ãƒƒãƒ•æ›´æ–°ï¼ˆç®¡ç†è€…ã®ã¿ï¼‰
- âœ… DELETE `/api/v1/staff/{id}` - ã‚¹ã‚¿ãƒƒãƒ•å‰Šé™¤ï¼ˆç®¡ç†è€…ã®ã¿ï¼‰

### 6. äºˆç´„ç®¡ç†APIï¼ˆå®Œå…¨å®Ÿè£…ï¼‰
- âœ… GET `/api/v1/reservations` - äºˆç´„ä¸€è¦§ï¼ˆãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ä»˜ãï¼‰
- âœ… GET `/api/v1/reservations/{id}` - äºˆç´„è©³ç´°
- âœ… POST `/api/v1/reservations` - äºˆç´„ä½œæˆï¼ˆä¼æ¥­ã¾ãŸã¯ç®¡ç†è€…ï¼‰
- âœ… PUT `/api/v1/reservations/{id}` - äºˆç´„æ›´æ–°ï¼ˆä¼æ¥­ã¾ãŸã¯ç®¡ç†è€…ï¼‰
- âœ… DELETE `/api/v1/reservations/{id}` - äºˆç´„å‰Šé™¤ï¼ˆä¼æ¥­ã¾ãŸã¯ç®¡ç†è€…ï¼‰

### 7. å‹¤æ€ ç®¡ç†APIï¼ˆå®Œå…¨å®Ÿè£…ï¼‰
- âœ… POST `/api/v1/attendance/clock-in` - å‡ºå‹¤æ‰“åˆ»
- âœ… POST `/api/v1/attendance/clock-out` - é€€å‹¤æ‰“åˆ»
- âœ… GET `/api/v1/attendance` - å‹¤æ€ ä¸€è¦§ï¼ˆãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ä»˜ãï¼‰
- âœ… GET `/api/v1/attendance/{id}` - å‹¤æ€ è©³ç´°
- âœ… PUT `/api/v1/attendance/{id}` - å‹¤æ€ æ›´æ–°ï¼ˆç®¡ç†è€…ã®ã¿ï¼‰
- âœ… POST `/api/v1/attendance/{id}/approve` - å‹¤æ€ æ‰¿èªï¼ˆç®¡ç†è€…ã®ã¿ï¼‰
- âœ… DELETE `/api/v1/attendance/{id}` - å‹¤æ€ å‰Šé™¤ï¼ˆç®¡ç†è€…ã®ã¿ï¼‰

### 8. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿
- âœ… ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆï¼ˆ5ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰
  - users
  - companies
  - staff
  - reservations
  - attendance
- âœ… åˆæœŸãƒ‡ãƒ¼ã‚¿æŠ•å…¥
  - ç®¡ç†è€…: 1å
  - ä¼æ¥­ãƒ¦ãƒ¼ã‚¶ãƒ¼: 2å
  - ã‚¹ã‚¿ãƒƒãƒ•ãƒ¦ãƒ¼ã‚¶ãƒ¼: 5å
  - ä¼æ¥­æƒ…å ±: 2ç¤¾
  - ã‚¹ã‚¿ãƒƒãƒ•æƒ…å ±: 5å
  - äºˆç´„: 3ä»¶
  - å‹¤æ€ : 2ä»¶

---

## ğŸ”‘ ãƒ†ã‚¹ãƒˆã‚¢ã‚«ã‚¦ãƒ³ãƒˆ

### ãƒ­ã‚°ã‚¤ãƒ³æƒ…å ±
ã™ã¹ã¦ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰: `password123`

| ãƒ­ãƒ¼ãƒ« | ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ | èª¬æ˜ |
|--------|---------------|------|
| ç®¡ç†è€… | admin@orientalsynergy.com | ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†è€… |
| ä¼æ¥­ | company1@example.com | æ ªå¼ä¼šç¤¾A |
| ä¼æ¥­ | company2@example.com | æ ªå¼ä¼šç¤¾B |
| ã‚¹ã‚¿ãƒƒãƒ• | staff1@example.com | å±±ç”°èŠ±å­ |
| ã‚¹ã‚¿ãƒƒãƒ• | staff2@example.com | ä½è—¤ç¾å’² |
| ã‚¹ã‚¿ãƒƒãƒ• | staff3@example.com | éˆ´æœ¨å¥å¤ª |
| ã‚¹ã‚¿ãƒƒãƒ• | staff4@example.com | é«˜æ©‹æ„› |
| ã‚¹ã‚¿ãƒƒãƒ• | staff5@example.com | ç”°ä¸­å¤ªéƒ |

---

## ğŸŒ APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

### ã‚µãƒ¼ãƒãƒ¼æƒ…å ±
- **ãƒ™ãƒ¼ã‚¹URL**: `http://localhost:8000`
- **APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆSwagger UIï¼‰**: http://localhost:8000/api/docs
- **APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆReDocï¼‰**: http://localhost:8000/api/redoc

### ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
- `GET /` - ãƒ«ãƒ¼ãƒˆã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
- `GET /health` - ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯

### èªè¨¼
- `POST /api/v1/auth/login` - ãƒ­ã‚°ã‚¤ãƒ³
- `POST /api/v1/auth/refresh` - ãƒˆãƒ¼ã‚¯ãƒ³ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥
- `POST /api/v1/auth/logout` - ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
- `GET /api/v1/auth/me` - ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±

### ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†
- `GET /api/v1/users` - ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§
- `GET /api/v1/users/{id}` - ãƒ¦ãƒ¼ã‚¶ãƒ¼è©³ç´°
- `POST /api/v1/users` - ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆ
- `PUT /api/v1/users/{id}` - ãƒ¦ãƒ¼ã‚¶ãƒ¼æ›´æ–°
- `DELETE /api/v1/users/{id}` - ãƒ¦ãƒ¼ã‚¶ãƒ¼å‰Šé™¤

### ä¼æ¥­ç®¡ç†
- `GET /api/v1/companies` - ä¼æ¥­ä¸€è¦§
- `GET /api/v1/companies/{id}` - ä¼æ¥­è©³ç´°
- `POST /api/v1/companies` - ä¼æ¥­ä½œæˆ
- `PUT /api/v1/companies/{id}` - ä¼æ¥­æ›´æ–°
- `DELETE /api/v1/companies/{id}` - ä¼æ¥­å‰Šé™¤

### ã‚¹ã‚¿ãƒƒãƒ•ç®¡ç†
- `GET /api/v1/staff` - ã‚¹ã‚¿ãƒƒãƒ•ä¸€è¦§
- `GET /api/v1/staff/{id}` - ã‚¹ã‚¿ãƒƒãƒ•è©³ç´°
- `POST /api/v1/staff` - ã‚¹ã‚¿ãƒƒãƒ•ä½œæˆ
- `PUT /api/v1/staff/{id}` - ã‚¹ã‚¿ãƒƒãƒ•æ›´æ–°
- `DELETE /api/v1/staff/{id}` - ã‚¹ã‚¿ãƒƒãƒ•å‰Šé™¤

### äºˆç´„ç®¡ç†
- `GET /api/v1/reservations` - äºˆç´„ä¸€è¦§
- `GET /api/v1/reservations/{id}` - äºˆç´„è©³ç´°
- `POST /api/v1/reservations` - äºˆç´„ä½œæˆ
- `PUT /api/v1/reservations/{id}` - äºˆç´„æ›´æ–°
- `DELETE /api/v1/reservations/{id}` - äºˆç´„å‰Šé™¤

### å‹¤æ€ ç®¡ç†
- `POST /api/v1/attendance/clock-in` - å‡ºå‹¤æ‰“åˆ»
- `POST /api/v1/attendance/clock-out` - é€€å‹¤æ‰“åˆ»
- `GET /api/v1/attendance` - å‹¤æ€ ä¸€è¦§
- `GET /api/v1/attendance/{id}` - å‹¤æ€ è©³ç´°
- `PUT /api/v1/attendance/{id}` - å‹¤æ€ æ›´æ–°
- `POST /api/v1/attendance/{id}/approve` - å‹¤æ€ æ‰¿èª
- `DELETE /api/v1/attendance/{id}` - å‹¤æ€ å‰Šé™¤

---

## ğŸ“ APIä½¿ç”¨ä¾‹

### 1. ãƒ­ã‚°ã‚¤ãƒ³
```bash
curl -X POST http://localhost:8000/api/v1/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email": "admin@orientalsynergy.com", "password": "password123"}'
```

### 2. ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—
```bash
TOKEN="<your_access_token>"
curl -X GET http://localhost:8000/api/v1/auth/me \
  -H "Authorization: Bearer $TOKEN"
```

### 3. ä¼æ¥­ä¸€è¦§å–å¾—
```bash
curl -X GET "http://localhost:8000/api/v1/companies" \
  -H "Authorization: Bearer $TOKEN"
```

### 4. ã‚¹ã‚¿ãƒƒãƒ•æ¤œç´¢
```bash
curl -X GET "http://localhost:8000/api/v1/staff?search=å±±ç”°&is_available=true" \
  -H "Authorization: Bearer $TOKEN"
```

### 5. å‡ºå‹¤æ‰“åˆ»
```bash
curl -X POST http://localhost:8000/api/v1/attendance/clock-in \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "staff_id": 1,
    "work_date": "2026/01/08",
    "location": "å¤§é˜ªåºœå¤§é˜ªå¸‚åŒ—åŒºæ¢…ç”°1-1-1"
  }'
```

---

## ğŸ”§ ã‚µãƒ¼ãƒãƒ¼èµ·å‹•æ–¹æ³•

### é–‹ç™ºã‚µãƒ¼ãƒãƒ¼
```bash
cd backend
source venv/bin/activate
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åˆæœŸåŒ–
```bash
cd backend
source venv/bin/activate
python init_db.py
python seed_data.py
```

---

## ğŸ¯ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆPhase 2Bï¼‰

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¨ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®é€£æº
1. **APIçµ±åˆ**
   - ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIã¨ã®æ¥ç¶š
   - SWRã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒãƒ³ã‚°
   - ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

2. **èªè¨¼æ©Ÿèƒ½**
   - ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢å®Ÿè£…
   - èªè¨¼çŠ¶æ…‹ç®¡ç†ï¼ˆContext APIï¼‰
   - ãƒ«ãƒ¼ãƒˆã‚¬ãƒ¼ãƒ‰ï¼ˆèªè¨¼ãŒå¿…è¦ãªãƒšãƒ¼ã‚¸ã®ä¿è­·ï¼‰

3. **æ©Ÿèƒ½çµ±åˆ**
   - ç®¡ç†ç”»é¢ã¨APIã®æ¥ç¶š
   - ä¼æ¥­å´ç”»é¢ã¨APIã®æ¥ç¶š
   - ã‚¹ã‚¿ãƒƒãƒ•å´ç”»é¢ã¨APIã®æ¥ç¶š

---

## ğŸ“Š å®Ÿè£…çµ±è¨ˆ

- **APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆæ•°**: 35å€‹
- **ãƒ¢ãƒ‡ãƒ«æ•°**: 5å€‹
- **ã‚¹ã‚­ãƒ¼ãƒæ•°**: 15å€‹
- **èªè¨¼æ–¹å¼**: JWTï¼ˆBearer Tokenï¼‰
- **æ¨©é™ãƒ¬ãƒ™ãƒ«**: 3ç¨®é¡ï¼ˆç®¡ç†è€…ã€ä¼æ¥­ã€ã‚¹ã‚¿ãƒƒãƒ•ï¼‰

---

## ğŸ‰ ã¾ã¨ã‚

**Phase 2Aï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIå®Œæˆï¼‰ãŒæ­£å¸¸ã«å®Œäº†ã—ã¾ã—ãŸï¼**

ã™ã¹ã¦ã®ä¸»è¦APIãŒå®Ÿè£…ã•ã‚Œã€èªè¨¼ã‚·ã‚¹ãƒ†ãƒ ã€CRUDæ“ä½œã€æ¨©é™ç®¡ç†ãŒæ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã¾ã™ã€‚
æ¬¡ã®ãƒ•ã‚§ãƒ¼ã‚ºã§ã¯ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¨ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’é€£æºã•ã›ã¦ã€å®Œå…¨ãªãƒ•ãƒ«ã‚¹ã‚¿ãƒƒã‚¯ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Œæˆã•ã›ã¾ã™ã€‚

**å®Ÿè£…æœŸé–“**: ç´„2-3æ™‚é–“
**å®Ÿè£…è¡Œæ•°**: ç´„2,000è¡Œä»¥ä¸Šã®ã‚³ãƒ¼ãƒ‰

---

**ä½œæˆæ—¥**: 2026å¹´1æœˆ8æ—¥
**ä½œæˆè€…**: AIé–‹ç™ºã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ







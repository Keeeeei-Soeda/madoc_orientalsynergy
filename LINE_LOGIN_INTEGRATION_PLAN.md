# LINEãƒ­ã‚°ã‚¤ãƒ³é€£æº å®Ÿè£…è¨ˆç”»æ›¸

## ğŸ“‹ æ¦‚è¦

ç¤¾å“¡ãŒLINEã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½¿ç”¨ã—ã¦ãƒ­ã‚°ã‚¤ãƒ³ãƒ»äºˆç´„ç™»éŒ²ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹æ©Ÿèƒ½ã®å®Ÿè£…è¨ˆç”»ã§ã™ã€‚

---

## ğŸ¯ ç›®çš„ã¨ãƒ¡ãƒªãƒƒãƒˆ

### ãªãœLINEãƒ­ã‚°ã‚¤ãƒ³ã‚’å°å…¥ã™ã‚‹ã®ã‹ï¼Ÿ

1. **åˆ©ä¾¿æ€§ã®å‘ä¸Š**
   - ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ä¸è¦ã§ãƒ­ã‚°ã‚¤ãƒ³å¯èƒ½
   - LINEã‚¢ãƒ—ãƒªã‹ã‚‰ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹
   - å€‹åˆ¥ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç®¡ç†ãŒä¸è¦

2. **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®å‘ä¸Š**
   - LINEå´ã®èªè¨¼ã‚’åˆ©ç”¨
   - æœ¬äººç¢ºèªãŒå®¹æ˜“
   - ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰æ¼æ´©ãƒªã‚¹ã‚¯ãªã—

3. **ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã®æ”¹å–„**
   - ãƒ¯ãƒ³ã‚¿ãƒƒãƒ—ãƒ­ã‚°ã‚¤ãƒ³
   - æ—¢å­˜ã®LINEã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½¿ç”¨
   - ç¤¾å“¡ã”ã¨ã«å€‹åˆ¥ç®¡ç†å¯èƒ½

4. **ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£**
   - èª°ãŒç™»éŒ²ã—ãŸã‹è¿½è·¡å¯èƒ½
   - LINE IDã§ä¸€æ„ã«è­˜åˆ¥
   - å…±é€šã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®å•é¡Œã‚’è§£æ±º

---

## ğŸ”„ LINEãƒ­ã‚°ã‚¤ãƒ³ã®ãƒ•ãƒ­ãƒ¼

### åŸºæœ¬çš„ãªèªè¨¼ãƒ•ãƒ­ãƒ¼ï¼ˆOAuth 2.0ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¤¾å“¡    â”‚                                    â”‚ ã‚·ã‚¹ãƒ†ãƒ  â”‚
â”‚ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ï¼‰â”‚                                    â”‚ï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼‰â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                                                â”‚
     â”‚ 1. ãƒ­ã‚°ã‚¤ãƒ³ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯                      â”‚
     â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>  â”‚
     â”‚                                                â”‚
     â”‚ 2. LINEèªè¨¼ãƒšãƒ¼ã‚¸ã¸ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ                  â”‚
     â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
     â”‚                                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                         â”‚
â”‚   LINE   â”‚                                         â”‚
â”‚ èªè¨¼ã‚µãƒ¼ãƒãƒ¼ â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                         â”‚
     â”‚                                                â”‚
     â”‚ 3. LINEã‚¢ãƒ—ãƒªã§èªè¨¼                             â”‚
     â”‚ ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒLINEã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§æ‰¿èªï¼‰                â”‚
     â”‚                                                â”‚
     â”‚ 4. èªå¯ã‚³ãƒ¼ãƒ‰ã‚’è¿”å´ï¼ˆãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆï¼‰               â”‚
     â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚
     â”‚                                                â”‚
     â”‚ 5. èªå¯ã‚³ãƒ¼ãƒ‰ã‚’é€ä¿¡                             â”‚
     â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚                                                â”‚
     â”‚                                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”
     â”‚                                           â”‚ LINE  â”‚
     â”‚                                           â”‚ API   â”‚
     â”‚                                           â””â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                                                â”‚
     â”‚                             6. ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—â”‚
     â”‚                             <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
     â”‚                                                â”‚
     â”‚                             7. ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’å–å¾— â”‚
     â”‚                             â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚                             <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
     â”‚                                                â”‚
     â”‚ 8. JWTãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç™ºè¡Œ                            â”‚
     â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
     â”‚                                                â”‚
     â”‚ 9. ãƒ­ã‚°ã‚¤ãƒ³å®Œäº†ãƒ»ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã¸                 â”‚
     â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
     â”‚                                                â”‚
```

### è©³ç´°ãªã‚¹ãƒ†ãƒƒãƒ—

1. **ç¤¾å“¡ãŒãƒ­ã‚°ã‚¤ãƒ³ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯**
   - ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰: `/login` ãƒšãƒ¼ã‚¸

2. **LINEèªè¨¼ãƒšãƒ¼ã‚¸ã¸ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ**
   ```
   https://access.line.me/oauth2/v2.1/authorize
     ?response_type=code
     &client_id={YOUR_CHANNEL_ID}
     &redirect_uri={YOUR_CALLBACK_URL}
     &state={RANDOM_STRING}
     &scope=profile%20openid%20email
   ```

3. **ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒLINEã‚¢ãƒ—ãƒªã§æ‰¿èª**
   - LINEã‚¢ãƒ—ãƒªãŒèµ·å‹•
   - ã€Œãƒ­ã‚°ã‚¤ãƒ³ã‚’è¨±å¯ã—ã¾ã™ã‹ï¼Ÿã€ç”»é¢
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ‰¿èª

4. **èªå¯ã‚³ãƒ¼ãƒ‰ãŒè¿”å´ã•ã‚Œã‚‹**
   ```
   https://your-domain.com/auth/line/callback
     ?code=AUTHORIZATION_CODE
     &state=RANDOM_STRING
   ```

5. **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãŒã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—**
   ```
   POST https://api.line.me/oauth2/v2.1/token
   Content-Type: application/x-www-form-urlencoded
   
   grant_type=authorization_code
   &code=AUTHORIZATION_CODE
   &redirect_uri={YOUR_CALLBACK_URL}
   &client_id={YOUR_CHANNEL_ID}
   &client_secret={YOUR_CHANNEL_SECRET}
   ```

6. **ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’å–å¾—**
   ```
   GET https://api.line.me/v2/profile
   Authorization: Bearer {ACCESS_TOKEN}
   ```
   
   ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä¾‹ï¼š
   ```json
   {
     "userId": "U1234567890abcdef1234567890abcdef",
     "displayName": "å±±ç”°å¤ªéƒ",
     "pictureUrl": "https://profile.line-scdn.net/...",
     "statusMessage": "Hello, LINE!"
   }
   ```

7. **ã‚·ã‚¹ãƒ†ãƒ ã®JWTãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç™ºè¡Œ**
   - LINE IDã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’ç´ä»˜ã‘
   - æ—¢å­˜ãƒ¦ãƒ¼ã‚¶ãƒ¼ãªã‚‰ãƒ­ã‚°ã‚¤ãƒ³
   - æ–°è¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ãªã‚‰ç™»éŒ²

8. **ãƒ­ã‚°ã‚¤ãƒ³å®Œäº†**

---

## ğŸ› ï¸ å®Ÿè£…ã«å¿…è¦ãªæº–å‚™

### 1. LINE Developers ã¸ã®ç™»éŒ²

#### ã‚¹ãƒ†ãƒƒãƒ—1: ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®ä½œæˆ
```
1. https://developers.line.biz/ ã«ã‚¢ã‚¯ã‚»ã‚¹
2. ã€Œãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚’ä½œæˆã€ã‚’ã‚¯ãƒªãƒƒã‚¯
3. ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼åã‚’å…¥åŠ›ï¼ˆä¾‹: Oriental Synergyï¼‰
```

#### ã‚¹ãƒ†ãƒƒãƒ—2: LINEãƒ­ã‚°ã‚¤ãƒ³ãƒãƒ£ãƒãƒ«ã®ä½œæˆ
```
1. ä½œæˆã—ãŸãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚’é¸æŠ
2. ã€Œãƒãƒ£ãƒãƒ«ã‚’ä½œæˆã€â†’ã€ŒLINEãƒ­ã‚°ã‚¤ãƒ³ã€ã‚’é¸æŠ
3. å¿…è¦äº‹é …ã‚’å…¥åŠ›:
   - ãƒãƒ£ãƒãƒ«å: Oriental Synergy ç¤¾å“¡ãƒ­ã‚°ã‚¤ãƒ³
   - ãƒãƒ£ãƒãƒ«èª¬æ˜: ç¤¾å“¡ç”¨äºˆç´„ç™»éŒ²ã‚·ã‚¹ãƒ†ãƒ 
   - ã‚¢ãƒ—ãƒªã‚¿ã‚¤ãƒ—: ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒª
```

#### ã‚¹ãƒ†ãƒƒãƒ—3: ãƒãƒ£ãƒãƒ«è¨­å®š
```
1. ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯URLã‚’è¨­å®š:
   - é–‹ç™ºç’°å¢ƒ: http://localhost:3000/auth/line/callback
   - æœ¬ç•ªç’°å¢ƒ: https://your-domain.com/auth/line/callback

2. å¿…è¦ãªæ¨©é™ï¼ˆã‚¹ã‚³ãƒ¼ãƒ—ï¼‰ã‚’è¨­å®š:
   - profile: ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æƒ…å ±ï¼ˆå¿…é ˆï¼‰
   - openid: OpenID Connectï¼ˆæ¨å¥¨ï¼‰
   - email: ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
```

#### ã‚¹ãƒ†ãƒƒãƒ—4: èªè¨¼æƒ…å ±ã‚’å–å¾—
```
ä»¥ä¸‹ã®æƒ…å ±ã‚’ãƒ¡ãƒ¢:
- Channel ID: 1234567890
- Channel Secret: abcdef1234567890abcdef1234567890
```

---

## ğŸ“Š ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ

### 1. Userãƒ†ãƒ¼ãƒ–ãƒ«ã®ä¿®æ­£

**è¿½åŠ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰:**

```python
class User(Base):
    __tablename__ = "users"
    
    id = Column(Integer, primary_key=True, index=True)
    email = Column(String(255), unique=True, index=True, nullable=True)  # nullable=Trueã«å¤‰æ›´
    password_hash = Column(String(255), nullable=True)  # nullable=Trueã«å¤‰æ›´
    name = Column(String(100), nullable=False)
    role = Column(SQLEnum(UserRole), nullable=False)
    is_active = Column(Boolean, default=True, nullable=False)
    company_id = Column(Integer, ForeignKey("companies.id"), nullable=True)
    
    # LINEé€£æºç”¨ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼ˆæ–°è¦è¿½åŠ ï¼‰
    line_id = Column(String(255), unique=True, nullable=True, index=True)
    line_display_name = Column(String(100), nullable=True)
    line_picture_url = Column(Text, nullable=True)
    line_access_token = Column(Text, nullable=True)  # æš—å·åŒ–æ¨å¥¨
    line_refresh_token = Column(Text, nullable=True)  # æš—å·åŒ–æ¨å¥¨
    
    created_at = Column(DateTime(timezone=True), server_default=func.now())
    updated_at = Column(DateTime(timezone=True), server_default=func.now(), onupdate=func.now())
```

### 2. æ–°ã—ã„ãƒ†ãƒ¼ãƒ–ãƒ«: line_registrationsï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

ç¤¾å“¡ãŒLINEã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ç™»éŒ²ã™ã‚‹éš›ã®ä¸€æ™‚ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜

```python
class LineRegistration(Base):
    """LINEç™»éŒ²ç”³è«‹ãƒ†ãƒ¼ãƒ–ãƒ«"""
    __tablename__ = "line_registrations"
    
    id = Column(Integer, primary_key=True, index=True)
    company_id = Column(Integer, ForeignKey("companies.id"), nullable=False)
    line_id = Column(String(255), unique=True, nullable=False)
    line_display_name = Column(String(100))
    line_picture_url = Column(Text)
    
    # ç¤¾å“¡æƒ…å ±
    employee_name = Column(String(100), nullable=False)
    department = Column(String(100), nullable=False)
    position = Column(String(100))
    phone = Column(String(20))
    email = Column(String(255))
    
    # ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
    status = Column(String(20), default='pending')  # pending, approved, rejected
    approved_by = Column(Integer, ForeignKey("users.id"), nullable=True)
    approved_at = Column(DateTime(timezone=True), nullable=True)
    
    created_at = Column(DateTime(timezone=True), server_default=func.now())
    updated_at = Column(DateTime(timezone=True), server_default=func.now(), onupdate=func.now())
```

---

## ğŸ”§ å®Ÿè£…å†…å®¹

### 1. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å®Ÿè£…

#### 1-1. ç’°å¢ƒå¤‰æ•°ã®è¨­å®š

**ãƒ•ã‚¡ã‚¤ãƒ«:** `backend/.env`

```bash
# LINE Login Configuration
LINE_CHANNEL_ID=1234567890
LINE_CHANNEL_SECRET=abcdef1234567890abcdef1234567890
LINE_CALLBACK_URL=http://localhost:3000/auth/line/callback
LINE_LOGIN_BASE_URL=https://access.line.me/oauth2/v2.1
LINE_API_BASE_URL=https://api.line.me
```

#### 1-2. LINEèªè¨¼ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®å®Ÿè£…

**ãƒ•ã‚¡ã‚¤ãƒ«:** `backend/app/api/v1/auth.py`

```python
from fastapi import APIRouter, Depends, HTTPException, Query
from typing import Optional
import requests
import secrets

router = APIRouter()

# LINEèªè¨¼URLã‚’ç”Ÿæˆ
@router.get("/auth/line/url")
def get_line_login_url():
    """
    LINEèªè¨¼URLã‚’ç”Ÿæˆã—ã¦è¿”ã™
    """
    state = secrets.token_urlsafe(32)  # CSRFå¯¾ç­–ç”¨ã®ãƒ©ãƒ³ãƒ€ãƒ æ–‡å­—åˆ—
    
    # Redisãªã©ã«ä¸€æ™‚ä¿å­˜ï¼ˆ5åˆ†é–“æœ‰åŠ¹ï¼‰
    # redis.setex(f"line_state:{state}", 300, "valid")
    
    params = {
        "response_type": "code",
        "client_id": settings.LINE_CHANNEL_ID,
        "redirect_uri": settings.LINE_CALLBACK_URL,
        "state": state,
        "scope": "profile openid email"
    }
    
    auth_url = f"{settings.LINE_LOGIN_BASE_URL}/authorize"
    query_string = "&".join([f"{k}={v}" for k, v in params.items()])
    
    return {
        "url": f"{auth_url}?{query_string}",
        "state": state
    }


# LINEã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†
@router.get("/auth/line/callback")
async def line_callback(
    code: str = Query(...),
    state: str = Query(...),
    db: Session = Depends(get_db)
):
    """
    LINEã‹ã‚‰ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’å‡¦ç†
    """
    # 1. stateã‚’æ¤œè¨¼ï¼ˆCSRFå¯¾ç­–ï¼‰
    # stored_state = redis.get(f"line_state:{state}")
    # if not stored_state:
    #     raise HTTPException(status_code=400, detail="Invalid state")
    
    # 2. ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—
    token_response = requests.post(
        f"{settings.LINE_API_BASE_URL}/oauth2/v2.1/token",
        headers={"Content-Type": "application/x-www-form-urlencoded"},
        data={
            "grant_type": "authorization_code",
            "code": code,
            "redirect_uri": settings.LINE_CALLBACK_URL,
            "client_id": settings.LINE_CHANNEL_ID,
            "client_secret": settings.LINE_CHANNEL_SECRET
        }
    )
    
    if token_response.status_code != 200:
        raise HTTPException(
            status_code=400,
            detail="Failed to get access token"
        )
    
    token_data = token_response.json()
    line_access_token = token_data["access_token"]
    
    # 3. ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’å–å¾—
    profile_response = requests.get(
        f"{settings.LINE_API_BASE_URL}/v2/profile",
        headers={"Authorization": f"Bearer {line_access_token}"}
    )
    
    if profile_response.status_code != 200:
        raise HTTPException(
            status_code=400,
            detail="Failed to get profile"
        )
    
    profile_data = profile_response.json()
    line_user_id = profile_data["userId"]
    line_display_name = profile_data.get("displayName")
    line_picture_url = profile_data.get("pictureUrl")
    
    # 4. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’æ¤œç´¢ã¾ãŸã¯ä½œæˆ
    user = db.query(User).filter(User.line_id == line_user_id).first()
    
    if user:
        # æ—¢å­˜ãƒ¦ãƒ¼ã‚¶ãƒ¼: ãƒ­ã‚°ã‚¤ãƒ³
        user.line_access_token = line_access_token
        user.line_display_name = line_display_name
        user.line_picture_url = line_picture_url
        user.updated_at = func.now()
        db.commit()
        
        # JWTãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç™ºè¡Œ
        access_token = create_access_token(data={"sub": str(user.id)})
        
        return {
            "access_token": access_token,
            "token_type": "bearer",
            "user": user
        }
    else:
        # æ–°è¦ãƒ¦ãƒ¼ã‚¶ãƒ¼: ç™»éŒ²ç”»é¢ã¸
        # ä¸€æ™‚ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç™ºè¡Œ
        temp_token = secrets.token_urlsafe(32)
        
        # Redisã«ä¸€æ™‚ä¿å­˜ï¼ˆ10åˆ†é–“æœ‰åŠ¹ï¼‰
        # redis.setex(
        #     f"line_temp:{temp_token}",
        #     600,
        #     json.dumps({
        #         "line_id": line_user_id,
        #         "display_name": line_display_name,
        #         "picture_url": line_picture_url,
        #         "access_token": line_access_token
        #     })
        # )
        
        return {
            "status": "registration_required",
            "temp_token": temp_token,
            "line_user": {
                "userId": line_user_id,
                "displayName": line_display_name,
                "pictureUrl": line_picture_url
            }
        }


# LINEç™»éŒ²å®Œäº†
@router.post("/auth/line/register")
async def complete_line_registration(
    temp_token: str,
    company_code: str,
    employee_name: str,
    department: str,
    position: Optional[str] = None,
    phone: Optional[str] = None,
    email: Optional[str] = None,
    db: Session = Depends(get_db)
):
    """
    LINEç™»éŒ²ã‚’å®Œäº†ã™ã‚‹
    """
    # 1. ä¸€æ™‚ãƒˆãƒ¼ã‚¯ãƒ³ã‹ã‚‰æƒ…å ±ã‚’å–å¾—
    # line_data = redis.get(f"line_temp:{temp_token}")
    # if not line_data:
    #     raise HTTPException(status_code=400, detail="Invalid or expired token")
    
    # line_info = json.loads(line_data)
    
    # 2. ä¼æ¥­ã‚³ãƒ¼ãƒ‰ã‚’æ¤œè¨¼
    company = db.query(Company).filter(
        Company.company_code == company_code
    ).first()
    
    if not company:
        raise HTTPException(status_code=404, detail="Company not found")
    
    # 3. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä½œæˆ
    new_user = User(
        name=employee_name,
        role=UserRole.EMPLOYEE,
        is_active=True,
        company_id=company.id,
        line_id=line_info["line_id"],
        line_display_name=line_info["display_name"],
        line_picture_url=line_info["picture_url"],
        line_access_token=line_info["access_token"]
    )
    
    db.add(new_user)
    db.commit()
    db.refresh(new_user)
    
    # 4. ç™»éŒ²ç”³è«‹ã‚’è¨˜éŒ²ï¼ˆæ‰¿èªãƒ•ãƒ­ãƒ¼ãŒã‚ã‚‹å ´åˆï¼‰
    # registration = LineRegistration(
    #     company_id=company.id,
    #     line_id=line_info["line_id"],
    #     employee_name=employee_name,
    #     department=department,
    #     ...
    # )
    # db.add(registration)
    # db.commit()
    
    # 5. JWTãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç™ºè¡Œ
    access_token = create_access_token(data={"sub": str(new_user.id)})
    
    return {
        "access_token": access_token,
        "token_type": "bearer",
        "user": new_user
    }
```

---

### 2. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å®Ÿè£…

#### 2-1. LINEãƒ­ã‚°ã‚¤ãƒ³ãƒœã‚¿ãƒ³ã®è¿½åŠ 

**ãƒ•ã‚¡ã‚¤ãƒ«:** `frontend/src/app/login/page.tsx`

```tsx
'use client'

import React, { useState } from 'react'
import { useRouter } from 'next/navigation'
import { useAuth } from '@/lib/auth/AuthContext'
import { lineAuthApi } from '@/lib/api'

export default function LoginPage() {
  const router = useRouter()
  const { login } = useAuth()
  
  // é€šå¸¸ã®ãƒ­ã‚°ã‚¤ãƒ³ï¼ˆæ—¢å­˜ï¼‰
  const handleLogin = async (e: React.FormEvent) => {
    // ... æ—¢å­˜ã®ã‚³ãƒ¼ãƒ‰
  }
  
  // LINEãƒ­ã‚°ã‚¤ãƒ³ï¼ˆæ–°è¦ï¼‰
  const handleLineLogin = async () => {
    try {
      // LINEèªè¨¼URLã‚’å–å¾—
      const { url, state } = await lineAuthApi.getLoginUrl()
      
      // stateã‚’ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜
      sessionStorage.setItem('line_login_state', state)
      
      // LINEèªè¨¼ãƒšãƒ¼ã‚¸ã¸ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
      window.location.href = url
    } catch (error) {
      console.error('LINEãƒ­ã‚°ã‚¤ãƒ³ã‚¨ãƒ©ãƒ¼:', error)
      alert('LINEãƒ­ã‚°ã‚¤ãƒ³ã«å¤±æ•—ã—ã¾ã—ãŸ')
    }
  }
  
  return (
    <div className="login-page">
      <div className="card">
        <div className="card-body">
          <h3 className="text-center mb-4">ãƒ­ã‚°ã‚¤ãƒ³</h3>
          
          {/* é€šå¸¸ã®ãƒ­ã‚°ã‚¤ãƒ³ãƒ•ã‚©ãƒ¼ãƒ ï¼ˆæ—¢å­˜ï¼‰ */}
          <form onSubmit={handleLogin}>
            {/* ... */}
            <button type="submit" className="btn btn-primary w-100">
              ãƒ­ã‚°ã‚¤ãƒ³
            </button>
          </form>
          
          {/* åŒºåˆ‡ã‚Šç·š */}
          <div className="divider my-4">
            <span>ã¾ãŸã¯</span>
          </div>
          
          {/* LINEãƒ­ã‚°ã‚¤ãƒ³ãƒœã‚¿ãƒ³ï¼ˆæ–°è¦ï¼‰ */}
          <button
            type="button"
            className="btn btn-success w-100"
            onClick={handleLineLogin}
          >
            <i className="bi bi-line me-2"></i>
            LINEã§ãƒ­ã‚°ã‚¤ãƒ³
          </button>
          
          <p className="text-center text-muted small mt-3">
            â€» LINEãƒ­ã‚°ã‚¤ãƒ³ã¯ç¤¾å“¡ã®æ–¹ã®ã¿ã”åˆ©ç”¨ã„ãŸã ã‘ã¾ã™
          </p>
        </div>
      </div>
      
      <style jsx>{`
        .divider {
          text-align: center;
          position: relative;
        }
        
        .divider::before {
          content: '';
          position: absolute;
          top: 50%;
          left: 0;
          right: 0;
          height: 1px;
          background: #dee2e6;
          z-index: 0;
        }
        
        .divider span {
          background: white;
          padding: 0 1rem;
          position: relative;
          z-index: 1;
          color: #6c757d;
        }
      `}</style>
    </div>
  )
}
```

#### 2-2. LINEã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒšãƒ¼ã‚¸ã®ä½œæˆ

**ãƒ•ã‚¡ã‚¤ãƒ«:** `frontend/src/app/auth/line/callback/page.tsx`

```tsx
'use client'

import React, { useEffect, useState } from 'react'
import { useRouter, useSearchParams } from 'next/navigation'
import { lineAuthApi } from '@/lib/api'
import Cookies from 'js-cookie'

export default function LineCallbackPage() {
  const router = useRouter()
  const searchParams = useSearchParams()
  const [loading, setLoading] = useState(true)
  const [error, setError] = useState<string | null>(null)
  
  useEffect(() => {
    const handleCallback = async () => {
      const code = searchParams.get('code')
      const state = searchParams.get('state')
      
      if (!code || !state) {
        setError('èªè¨¼æƒ…å ±ãŒä¸æ­£ã§ã™')
        setLoading(false)
        return
      }
      
      // stateã‚’æ¤œè¨¼
      const savedState = sessionStorage.getItem('line_login_state')
      if (savedState !== state) {
        setError('èªè¨¼çŠ¶æ…‹ãŒä¸€è‡´ã—ã¾ã›ã‚“')
        setLoading(false)
        return
      }
      
      try {
        // ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯APIã‚’å‘¼ã³å‡ºã—
        const result = await lineAuthApi.handleCallback(code, state)
        
        if (result.status === 'registration_required') {
          // æ–°è¦ãƒ¦ãƒ¼ã‚¶ãƒ¼: ç™»éŒ²ç”»é¢ã¸
          sessionStorage.setItem('line_temp_token', result.temp_token)
          sessionStorage.setItem('line_user', JSON.stringify(result.line_user))
          router.push('/auth/line/register')
        } else {
          // æ—¢å­˜ãƒ¦ãƒ¼ã‚¶ãƒ¼: ãƒ­ã‚°ã‚¤ãƒ³å®Œäº†
          Cookies.set('access_token', result.access_token, { expires: 7 })
          router.push('/employee/bookings')
        }
      } catch (err) {
        setError('èªè¨¼å‡¦ç†ã«å¤±æ•—ã—ã¾ã—ãŸ')
        setLoading(false)
      }
    }
    
    handleCallback()
  }, [searchParams, router])
  
  if (loading) {
    return (
      <div className="min-vh-100 d-flex align-items-center justify-content-center">
        <div className="text-center">
          <div className="spinner-border text-primary mb-3" role="status">
            <span className="visually-hidden">å‡¦ç†ä¸­...</span>
          </div>
          <p className="text-muted">LINEãƒ­ã‚°ã‚¤ãƒ³å‡¦ç†ä¸­...</p>
        </div>
      </div>
    )
  }
  
  if (error) {
    return (
      <div className="min-vh-100 d-flex align-items-center justify-content-center">
        <div className="text-center">
          <i className="bi bi-exclamation-triangle text-danger fs-1 mb-3"></i>
          <p className="text-danger">{error}</p>
          <button
            className="btn btn-primary mt-3"
            onClick={() => router.push('/login')}
          >
            ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã¸æˆ»ã‚‹
          </button>
        </div>
      </div>
    )
  }
  
  return null
}
```

#### 2-3. LINEç™»éŒ²ç”»é¢ã®ä½œæˆ

**ãƒ•ã‚¡ã‚¤ãƒ«:** `frontend/src/app/auth/line/register/page.tsx`

```tsx
'use client'

import React, { useState, useEffect } from 'react'
import { useRouter } from 'next/navigation'
import { lineAuthApi } from '@/lib/api'

export default function LineRegisterPage() {
  const router = useRouter()
  const [lineUser, setLineUser] = useState<any>(null)
  const [formData, setFormData] = useState({
    company_code: '',
    employee_name: '',
    department: '',
    position: '',
    phone: '',
    email: '',
  })
  const [submitting, setSubmitting] = useState(false)
  
  useEffect(() => {
    // LINEãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’å–å¾—
    const lineUserData = sessionStorage.getItem('line_user')
    if (lineUserData) {
      setLineUser(JSON.parse(lineUserData))
    } else {
      // LINEãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ãŒãªã„å ´åˆã¯ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã¸
      router.push('/login')
    }
  }, [router])
  
  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault()
    
    if (!formData.company_code || !formData.employee_name || !formData.department) {
      alert('å¿…é ˆé …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„')
      return
    }
    
    try {
      setSubmitting(true)
      
      const tempToken = sessionStorage.getItem('line_temp_token')
      if (!tempToken) {
        throw new Error('ä¸€æ™‚ãƒˆãƒ¼ã‚¯ãƒ³ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“')
      }
      
      const result = await lineAuthApi.completeRegistration({
        temp_token: tempToken,
        ...formData
      })
      
      // ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä¿å­˜
      Cookies.set('access_token', result.access_token, { expires: 7 })
      
      // ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚’ã‚¯ãƒªã‚¢
      sessionStorage.removeItem('line_temp_token')
      sessionStorage.removeItem('line_user')
      sessionStorage.removeItem('line_login_state')
      
      alert('ç™»éŒ²ãŒå®Œäº†ã—ã¾ã—ãŸï¼')
      router.push('/employee/bookings')
    } catch (error) {
      alert('ç™»éŒ²ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + (error instanceof Error ? error.message : ''))
    } finally {
      setSubmitting(false)
    }
  }
  
  if (!lineUser) {
    return (
      <div className="min-vh-100 d-flex align-items-center justify-content-center">
        <div className="spinner-border text-primary" role="status">
          <span className="visually-hidden">èª­ã¿è¾¼ã¿ä¸­...</span>
        </div>
      </div>
    )
  }
  
  return (
    <div className="container py-5">
      <div className="row justify-content-center">
        <div className="col-12 col-md-8 col-lg-6">
          <div className="card">
            <div className="card-header bg-success text-white">
              <h4 className="mb-0">
                <i className="bi bi-line me-2"></i>
                LINEç™»éŒ²
              </h4>
            </div>
            <div className="card-body">
              {/* LINEãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±è¡¨ç¤º */}
              <div className="alert alert-info mb-4">
                <div className="d-flex align-items-center">
                  {lineUser.pictureUrl && (
                    <img
                      src={lineUser.pictureUrl}
                      alt="ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒ"
                      className="rounded-circle me-3"
                      style={{ width: 50, height: 50 }}
                    />
                  )}
                  <div>
                    <strong>LINEã‚¢ã‚«ã‚¦ãƒ³ãƒˆ</strong>
                    <br />
                    {lineUser.displayName}
                  </div>
                </div>
              </div>
              
              {/* ç™»éŒ²ãƒ•ã‚©ãƒ¼ãƒ  */}
              <form onSubmit={handleSubmit}>
                <div className="mb-3">
                  <label htmlFor="company_code" className="form-label">
                    ä¼æ¥­ã‚³ãƒ¼ãƒ‰ <span className="text-danger">*</span>
                  </label>
                  <input
                    type="text"
                    className="form-control"
                    id="company_code"
                    value={formData.company_code}
                    onChange={(e) => setFormData({...formData, company_code: e.target.value})}
                    required
                    placeholder="ä¾‹: COMP001"
                  />
                  <small className="text-muted">
                    â€» ä¼æ¥­æ‹…å½“è€…ã‹ã‚‰æä¾›ã•ã‚ŒãŸä¼æ¥­ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
                  </small>
                </div>
                
                <div className="mb-3">
                  <label htmlFor="employee_name" className="form-label">
                    æ°å <span className="text-danger">*</span>
                  </label>
                  <input
                    type="text"
                    className="form-control"
                    id="employee_name"
                    value={formData.employee_name}
                    onChange={(e) => setFormData({...formData, employee_name: e.target.value})}
                    required
                    placeholder="ä¾‹: å±±ç”°å¤ªéƒ"
                  />
                </div>
                
                <div className="mb-3">
                  <label htmlFor="department" className="form-label">
                    éƒ¨ç½² <span className="text-danger">*</span>
                  </label>
                  <input
                    type="text"
                    className="form-control"
                    id="department"
                    value={formData.department}
                    onChange={(e) => setFormData({...formData, department: e.target.value})}
                    required
                    placeholder="ä¾‹: å–¶æ¥­éƒ¨"
                  />
                </div>
                
                <div className="mb-3">
                  <label htmlFor="position" className="form-label">
                    å½¹è·
                  </label>
                  <input
                    type="text"
                    className="form-control"
                    id="position"
                    value={formData.position}
                    onChange={(e) => setFormData({...formData, position: e.target.value})}
                    placeholder="ä¾‹: èª²é•·"
                  />
                </div>
                
                <div className="mb-3">
                  <label htmlFor="phone" className="form-label">
                    é›»è©±ç•ªå·
                  </label>
                  <input
                    type="tel"
                    className="form-control"
                    id="phone"
                    value={formData.phone}
                    onChange={(e) => setFormData({...formData, phone: e.target.value})}
                    placeholder="ä¾‹: 090-1234-5678"
                  />
                </div>
                
                <div className="mb-3">
                  <label htmlFor="email" className="form-label">
                    ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹
                  </label>
                  <input
                    type="email"
                    className="form-control"
                    id="email"
                    value={formData.email}
                    onChange={(e) => setFormData({...formData, email: e.target.value})}
                    placeholder="ä¾‹: yamada@example.com"
                  />
                </div>
                
                <div className="d-grid gap-2">
                  <button
                    type="submit"
                    className="btn btn-success"
                    disabled={submitting}
                  >
                    {submitting ? (
                      <>
                        <span className="spinner-border spinner-border-sm me-2"></span>
                        ç™»éŒ²ä¸­...
                      </>
                    ) : (
                      <>
                        <i className="bi bi-check-circle me-2"></i>
                        ç™»éŒ²ã™ã‚‹
                      </>
                    )}
                  </button>
                  <button
                    type="button"
                    className="btn btn-outline-secondary"
                    onClick={() => router.push('/login')}
                    disabled={submitting}
                  >
                    ã‚­ãƒ£ãƒ³ã‚»ãƒ«
                  </button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  )
}
```

---

## ğŸ“± é‹ç”¨ãƒ•ãƒ­ãƒ¼

### ãƒ‘ã‚¿ãƒ¼ãƒ³1: åˆå›ç™»éŒ²ï¼ˆæ‰¿èªãƒ•ãƒ­ãƒ¼ãªã—ï¼‰

```
1. ç¤¾å“¡ãŒLINEãƒ­ã‚°ã‚¤ãƒ³ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
   â†“
2. LINEã‚¢ãƒ—ãƒªã§èªè¨¼
   â†“
3. ç™»éŒ²ç”»é¢ã¸ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
   â†“
4. ä¼æ¥­ã‚³ãƒ¼ãƒ‰ + ç¤¾å“¡æƒ…å ±ã‚’å…¥åŠ›
   â†“
5. ç™»éŒ²å®Œäº†
   â†“
6. /employee/bookings ã¸è‡ªå‹•é·ç§»
```

### ãƒ‘ã‚¿ãƒ¼ãƒ³2: åˆå›ç™»éŒ²ï¼ˆæ‰¿èªãƒ•ãƒ­ãƒ¼ã‚ã‚Šï¼‰

```
1. ç¤¾å“¡ãŒLINEãƒ­ã‚°ã‚¤ãƒ³ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
   â†“
2. LINEã‚¢ãƒ—ãƒªã§èªè¨¼
   â†“
3. ç™»éŒ²ç”»é¢ã¸ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
   â†“
4. ä¼æ¥­ã‚³ãƒ¼ãƒ‰ + ç¤¾å“¡æƒ…å ±ã‚’å…¥åŠ›
   â†“
5. ã€Œç™»éŒ²ç”³è«‹ã‚’é€ä¿¡ã—ã¾ã—ãŸã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
   â†“
6. ä¼æ¥­æ‹…å½“è€…ã¾ãŸã¯ç®¡ç†è€…ãŒæ‰¿èª
   â†“
7. æ‰¿èªå¾Œã€ç¤¾å“¡ã«LINEé€šçŸ¥
   â†“
8. å†åº¦LINEãƒ­ã‚°ã‚¤ãƒ³ã§ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
```

### ãƒ‘ã‚¿ãƒ¼ãƒ³3: 2å›ç›®ä»¥é™ã®ãƒ­ã‚°ã‚¤ãƒ³

```
1. ç¤¾å“¡ãŒLINEãƒ­ã‚°ã‚¤ãƒ³ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
   â†“
2. LINEã‚¢ãƒ—ãƒªã§èªè¨¼
   â†“
3. /employee/bookings ã¸è‡ªå‹•é·ç§»
   ï¼ˆç™»éŒ²ç”»é¢ã¯è¡¨ç¤ºã•ã‚Œãªã„ï¼‰
```

---

## ğŸ¨ ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“

### ãƒ¡ãƒªãƒƒãƒˆ

1. **è¶…ç°¡å˜ãƒ­ã‚°ã‚¤ãƒ³**
   - ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ä¸è¦
   - LINEã‚¢ãƒ—ãƒªã§ãƒ¯ãƒ³ã‚¿ãƒƒãƒ—
   - è¦šãˆã‚‹ã®ã¯ä¼æ¥­ã‚³ãƒ¼ãƒ‰ã ã‘

2. **å€‹åˆ¥ç®¡ç†**
   - ç¤¾å“¡ã”ã¨ã«å€‹åˆ¥ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ
   - èª°ãŒç™»éŒ²ã—ãŸã‹è¿½è·¡å¯èƒ½
   - å…±é€šã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®å•é¡Œã‚’è§£æ±º

3. **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**
   - LINEå´ã®èªè¨¼ã‚’åˆ©ç”¨
   - æœ¬äººç¢ºèªãŒå®¹æ˜“
   - ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰æ¼æ´©ãƒªã‚¹ã‚¯ãªã—

### ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ

1. **LINEå¿…é ˆ**
   - LINEã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒãªã„ã¨ä½¿ãˆãªã„
   - æ—¥æœ¬å›½å†…é™å®šï¼ˆæµ·å¤–ã§ã¯æ™®åŠç‡ä½ã„ï¼‰

2. **åˆå›ç™»éŒ²ã®æ‰‹é–“**
   - ä¼æ¥­ã‚³ãƒ¼ãƒ‰ã®å…¥åŠ›ãŒå¿…è¦
   - ç¤¾å“¡æƒ…å ±ã®å…¥åŠ›ãŒå¿…è¦

---

## ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–

### 1. CSRFå¯¾ç­–
- `state`ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä½¿ç”¨
- ãƒ©ãƒ³ãƒ€ãƒ æ–‡å­—åˆ—ã‚’ç”Ÿæˆã—ã¦æ¤œè¨¼

### 2. ãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†
- ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã¯æš—å·åŒ–ã—ã¦ä¿å­˜
- å®šæœŸçš„ãªãƒˆãƒ¼ã‚¯ãƒ³æ›´æ–°

### 3. ä¼æ¥­ã‚³ãƒ¼ãƒ‰
- æ¨æ¸¬å›°é›£ãªãƒ©ãƒ³ãƒ€ãƒ æ–‡å­—åˆ—
- ä¼æ¥­ã”ã¨ã«ä¸€æ„
- å®šæœŸçš„ãªæ›´æ–°ã‚’æ¨å¥¨

### 4. æ‰¿èªãƒ•ãƒ­ãƒ¼ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
- ç®¡ç†è€…æ‰¿èªãŒå¿…è¦
- ãªã‚Šã™ã¾ã—é˜²æ­¢

---

## ğŸ’° ã‚³ã‚¹ãƒˆ

### LINE Developersã®åˆ©ç”¨æ–™é‡‘

**ç„¡æ–™**
- LINEãƒ­ã‚°ã‚¤ãƒ³æ©Ÿèƒ½ã¯ç„¡æ–™ã§åˆ©ç”¨å¯èƒ½
- APIå‘¼ã³å‡ºã—åˆ¶é™ãªã—
- ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°åˆ¶é™ãªã—

### é–‹ç™ºãƒ»é‹ç”¨ã‚³ã‚¹ãƒˆ

| é …ç›® | å·¥æ•°/ã‚³ã‚¹ãƒˆ |
|------|-----------|
| LINE Developersç™»éŒ² | 1æ™‚é–“ |
| ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å®Ÿè£… | 8æ™‚é–“ |
| ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å®Ÿè£… | 8æ™‚é–“ |
| ãƒ†ã‚¹ãƒˆ | 4æ™‚é–“ |
| ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆ | 2æ™‚é–“ |
| **åˆè¨ˆ** | **ç´„23æ™‚é–“ï¼ˆ3æ—¥ï¼‰** |

---

## ğŸ“Š å®Ÿè£…å„ªå…ˆåº¦

### Phase 1: åŸºæœ¬çš„ãªLINEãƒ­ã‚°ã‚¤ãƒ³
- LINEãƒ­ã‚°ã‚¤ãƒ³ãƒœã‚¿ãƒ³ã®è¿½åŠ 
- èªè¨¼ãƒ•ãƒ­ãƒ¼å®Ÿè£…
- æ–°è¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²
- **å·¥æ•°: ç´„16æ™‚é–“ï¼ˆ2æ—¥ï¼‰**

### Phase 2: æ‰¿èªãƒ•ãƒ­ãƒ¼
- ç™»éŒ²ç”³è«‹æ©Ÿèƒ½
- ç®¡ç†è€…æ‰¿èªç”»é¢
- LINEé€šçŸ¥æ©Ÿèƒ½
- **å·¥æ•°: ç´„8æ™‚é–“ï¼ˆ1æ—¥ï¼‰**

### Phase 3: æ—¢å­˜ãƒ¦ãƒ¼ã‚¶ãƒ¼é€£æº
- æ—¢å­˜ã®ç¤¾å“¡å…±é€šã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‹ã‚‰LINEã¸ã®ç§»è¡Œ
- ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
- **å·¥æ•°: ç´„4æ™‚é–“**

---

## âš ï¸ æ³¨æ„ç‚¹

### 1. LINE Business IDãŒå¿…è¦
- LINE Developersã¸ã®ç™»éŒ²ã«ã¯LINE Business IDãŒå¿…è¦
- ä¼æ¥­ã®ä»£è¡¨è€…ã¾ãŸã¯æ‹…å½“è€…ãŒç™»éŒ²

### 2. ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼å¿…é ˆ
- LINEãƒ­ã‚°ã‚¤ãƒ³ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã€ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼ã®æ²è¼‰ãŒå¿…é ˆ
- LINE Developersã®å¯©æŸ»ã§ç¢ºèªã•ã‚Œã‚‹

### 3. ä¼æ¥­ã‚³ãƒ¼ãƒ‰ã®ç®¡ç†
- ä¼æ¥­ã‚³ãƒ¼ãƒ‰ã®ç”Ÿæˆãƒ»ç®¡ç†æ–¹æ³•
- ç´›å¤±æ™‚ã®å¯¾å¿œãƒ•ãƒ­ãƒ¼
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–

### 4. ãƒ†ã‚¹ãƒˆç’°å¢ƒ
- LINE Developersã§é–‹ç™ºç”¨ãƒãƒ£ãƒãƒ«ã‚’ä½œæˆ
- æœ¬ç•ªç’°å¢ƒã¨ã¯åˆ¥ã®ãƒãƒ£ãƒãƒ«ã‚’ä½¿ç”¨

---

## ğŸš€ å®Ÿè£…é–‹å§‹å‰ã®ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] LINE Business IDã®å–å¾—
- [ ] LINE Developersã¸ã®ç™»éŒ²
- [ ] LINEãƒ­ã‚°ã‚¤ãƒ³ãƒãƒ£ãƒãƒ«ã®ä½œæˆ
- [ ] Channel ID / Channel Secretã®å–å¾—
- [ ] ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯URLã®è¨­å®š
- [ ] ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼ã®æº–å‚™
- [ ] ä¼æ¥­ã‚³ãƒ¼ãƒ‰ç”Ÿæˆãƒ«ãƒ¼ãƒ«ã®æ±ºå®š
- [ ] æ‰¿èªãƒ•ãƒ­ãƒ¼ã®æœ‰ç„¡ã‚’æ±ºå®š
- [ ] æ—¢å­˜ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç§»è¡Œæ–¹é‡ã‚’æ±ºå®š

---

## ğŸ“ ã¾ã¨ã‚

### LINEãƒ­ã‚°ã‚¤ãƒ³é€£æºã¯ä»¥ä¸‹ã®æµã‚Œã§é€²ã‚ã¾ã™:

1. **æº–å‚™**ï¼ˆ1æ™‚é–“ï¼‰
   - LINE Developersã¸ã®ç™»éŒ²
   - ãƒãƒ£ãƒãƒ«ä½œæˆ
   - èªè¨¼æƒ…å ±å–å¾—

2. **å®Ÿè£…**ï¼ˆ16æ™‚é–“ / 2æ—¥ï¼‰
   - ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIå®Ÿè£…
   - ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å®Ÿè£…
   - èªè¨¼ãƒ•ãƒ­ãƒ¼æ§‹ç¯‰

3. **ãƒ†ã‚¹ãƒˆ**ï¼ˆ4æ™‚é–“ï¼‰
   - æ–°è¦ç™»éŒ²ãƒ†ã‚¹ãƒˆ
   - ãƒ­ã‚°ã‚¤ãƒ³ãƒ†ã‚¹ãƒˆ
   - ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ç¢ºèª

4. **é‹ç”¨é–‹å§‹**
   - ä¼æ¥­ã‚³ãƒ¼ãƒ‰ã®ç™ºè¡Œ
   - ç¤¾å“¡ã¸ã®æ¡ˆå†…
   - ã‚µãƒãƒ¼ãƒˆä½“åˆ¶ã®æ§‹ç¯‰

### ãƒ¡ãƒªãƒƒãƒˆ
- âœ… ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ä¸è¦ã§ç°¡å˜ãƒ­ã‚°ã‚¤ãƒ³
- âœ… å€‹åˆ¥ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç®¡ç†
- âœ… ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å‘ä¸Š
- âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã®æ”¹å–„

### æ¨å¥¨ã‚¿ã‚¤ãƒŸãƒ³ã‚°
- ç¤¾å“¡å…±é€šã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼ˆEMPLOYEEï¼‰ã®å®Ÿè£…å¾Œ
- ã‚ã‚‹ç¨‹åº¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå¢—ãˆã¦ã‹ã‚‰
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¦ä»¶ãŒé«˜ã¾ã£ãŸã¨ã

---

æœ€çµ‚æ›´æ–°æ—¥: 2026å¹´1æœˆ23æ—¥

